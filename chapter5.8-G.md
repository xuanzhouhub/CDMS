# 图数据库设计

本节将主要介绍图数据库的结构设计。

通常，在设计数据模型时，人们会在白板上绘制示例数据，并将其与绘制的其他数据联系起来，以展示项目间的连接关系。图数据建模也是类似的过程，并且它不需要修改数据模型以适应规范化的表结构，而是保持与在白板上绘制时相同。

领域建模



##  设计规则

虽然无法适用于所有的情况，但下面这些通用指南将帮助我们选择何时使用节点或关系：
- 使用节点表示实体，即领域内我们感兴趣的事物，它们可以被标签和分组
- 使用关系表示实体之间的关联，并为每个实体建立语义上下文，从而构建领域。请注意，图中的边都是二元关系，关系必须存在一个开始节点和一个结束节点，不可多也不可少。任何大于2的n元有序边都应该被映射为一个有n条关联边的节点。
- 使用有向关系进一步阐明语义联系。对于双向关系，我们应在查询中忽略方向，而非使用两个关系。
- 使用节点属性以及任何必要的实体元数据来表示实体的属性。
- 使用关系属性以及任何必要的关系元数据来表示关系的强度、权重或质量。

## 图结构设计

基于以上的指南，我们可以对5.1节的购物网站进行图建模。

首先，我们需要制作数据模型的白板草图。当我们想要描述“用户购物”时，会对用户及商品分别创建一个节点，然后用一条有向边连接。根据5.1节的分析，我们知道用户和商品之间是多对多的关系，用图来表述则是一条n元边（n>2），因此我们需要将这种关系建模为一个“订单”节点，用户和商品分别通过订单相连。下图是我们看到的一个简化版的例子，里面只有几个用户、订单及商品。用户分别用节点user1和user2表示，他们创建了订单order1、order2和order3，订单中涉及的商品用节点item1、item2、item3和item4表示。

![[fig/5.8.1_1.png]]

当完成白板上的草图之后，我们只需要根据需求丰富该白板模型，添加相应的标签、属性和关系，如下图所示：



**测试模型**
章鱼书p34